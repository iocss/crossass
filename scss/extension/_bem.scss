// BEM extension for Crossass
//
// Copyright (c) 2014 Whizark
// @category bem

// The separator for modifiers
$x-bem-modifier-separator: '--' !default;

// The separator for element
$x-bem-element-separator: '__' !default;

// Generates and Returns a selector for modifier
// @function x-bem-modifier
// @param    $names         {String...} A modifier name
// @return                  {List}      The list of selectors
@function x-bem-modifier($names...) {
    @return x-prefixer($x-bem-modifier-separator, $names);
}

// Generates and Returns a selector for element
// @function x-bem-element
// @param    $names        {String...} An element name
// @return                 {List}      The list of selectors
@function x-bem-element($names...) {
    @return x-prefixer($x-bem-element-separator, $names);
}

// Defines modifier
// @mixin    x-bem-modifier
// @param    $names         {String...} Modifier name(s)
@mixin x-bem-modifier($names...) {
    $modifier-context: ();

    @at-root {
        @each $name in $names {
            $name: unquote($name);

            @if x--is-modifiable(#{&}) {
                $suffix: x-bem-modifier($name);
                $modifier: x-module--add-modifier(x-module--context('module'), #{$suffix});
                $parent-context: x-module--context('parent', #{&});
                $modifier-context: x-module--context('modifier', join($modifier-context, $modifier));

                #{&}#{$suffix} {
                    @content;
                }
            } @else {
                @warn 'The parent selector "#{&}" should be a single class selector or placeholder.';
            }
        }
    }
}

// Defines element
// @mixin    x-bem-element
// @param    $names        {String...} Element name(s)
@mixin x-bem-element($names...) {
    $modifier-context: ();

    @at-root {
        @each $name in $names {
            $name: unquote($name);

            @if x--is-modifiable(#{&}) {
                $suffix: x-bem-element($name);
                $modifier: x-module--add-modifier(x-module--context('module'), #{$suffix});
                $parent-context: x-module--context('parent', #{&});
                $modifier-context: x-module--context('modifier', join($modifier-context, $modifier));

                #{&}#{$suffix} {
                    @content;
                }
            } @else {
                @warn 'The parent selector "#{&}" should be a single class selector or placeholder.';
            }
        }
    }
}
